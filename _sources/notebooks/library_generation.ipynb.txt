{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Generating oligo libraries containing library members for DMS screens"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Importing libraries"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "from DMS_designer import LibraryMaker\n",
    "from matplotlib import pyplot as plt"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Creating the OCAT1 library"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Making singles\n",
      "1020 single mutants made\n",
      "0.001378 sec elapsed\n",
      "\n",
      "Making nt seqs\n",
      "0: 0pt_WT\n",
      "100: 1pt_05Y\n",
      "200: 1pt_10Y\n",
      "300: 1pt_15Y\n",
      "400: 1pt_20Y\n",
      "500: 1pt_25Y\n",
      "600: 1pt_30Y\n",
      "700: 1pt_35Y\n",
      "800: 1pt_40Y\n",
      "900: 1pt_45Y\n",
      "1000: 1pt_50Y\n",
      "5798 nt seqs made\n",
      "2.301042 sec elapsed\n",
      "\n",
      "./output/libraries/OCA-T1_180bp_orf_library_N=5798_time=25.07.02.15h.29m.17s.csv\n",
      "File saved\n",
      "3.149244 sec elapsed\n",
      "------------------------------------------------\n",
      "\n",
      "\n",
      "Processing ./output/libraries/OCA-T1_180bp_orf_library_N=5798_time=25.07.02.15h.29m.17s.csv\n",
      "WT aa seq (L=51):\n",
      "\tESVPGDYSKRVYQGVRVKHTVKDLLAEKRSGQTSNSRLNGSVSSSQSPFVQ\n",
      "WT dna seq (L=153):\n",
      "\tGAAAGCGTGCCAGGAGATTACAGCAAAAGAGTGTACCAGGGGGTGCGGGTGAAGCATACTGTGAAGGACCTGCTGGCTGAGAAAAGGAGCGGACAGACATCCAATTCCAGACTGAACGGCAGCGTGTCCTCCTCCCAGTCCCCTTTTGTGCAG\n",
      "WT oligo seq (L=184):\n",
      "\tgggATCCGCCACCATGGAAAGCGTGCCAGGAGATTACAGCAAAAGAGTGTACCAGGGGGTGCGGGTGAAGCATACTGTGAAGGACCTGCTGGCTGAGAAAAGGAGCGGACAGACATCCAATTCCAGACTGAACGGCAGCGTGTCCTCCTCCCAGTCCCCTTTTGTGCAGATGCCAGGTTCGCCG\n",
      "Number of 0 variants: 800\n",
      "Number of 1 variants: 4998\n",
      "Total number of variants: 5798\n",
      "Number of 0 mutant variants: 1\n",
      "Number of 1 mutant variants: 1020\n",
      "Fraction of possible 0 mutants: 1.0\n",
      "Fraction of possible 1 mutants: 1.0\n",
      "Total counts in 1 mutant heatmap: 4998.0\n",
      "Heatmap saved as 1pt_heatmap_OCA-T1_180bp_orf_library_N=5798_time=25.07.02.15h.29m.17s.pdf\n",
      "Mutant observances in 1 mutant heatmap: 1020.0\n",
      "Heatmap saved as 1pt_mutant_heatmap_OCA-T1_180bp_orf_library_N=5798_time=25.07.02.15h.29m.17s.pdf\n",
      "Number of 2pt variants: 0\n",
      "Output checked\n",
      "3.911143 sec elapsed\n"
     ]
    }
   ],
   "source": [
    "# make an all singles OCAT1 library\n",
    "\n",
    "lib = LibraryMaker('GAAAGCGTGCCAGGAGATTACAGCAAAAGAGTGTACCAGGGGGTGCGGGTGAAGCATACTGTGAAGGACCTGCTGGCTGAGAAAAGGAGCGGACAGACATCCAATTCCAGACTGAACGGCAGCGTGTCCTCCTCCCAGTCCCCTTTTGTGCAG', \n",
    "             single_mutants = True, \n",
    "             doubles_to_make = 0, \n",
    "             var_num = 5, wt_num = 800, max_tries = 100, stop_num=3,\n",
    "             upstream_dna = 'gggATCCGCCACCATG',\n",
    "             downstream_dna = 'ATGCCAGGTTCGCCG',\n",
    "             out_path='./output/libraries/', name='OCA-T1_180bp', fig_width=8,\n",
    "             fig_path='./output/figs/')\n",
    "plt.close('all')\n",
    " "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Creating the POU2F3 libraries"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Making singles\n",
      "1100 single mutants made\n",
      "0.001332 sec elapsed\n",
      "\n",
      "Making nt seqs\n",
      "0: 0pt_WT\n",
      "100: 1pt_05Y\n",
      "200: 1pt_10Y\n",
      "300: 1pt_15Y\n",
      "400: 1pt_20Y\n",
      "500: 1pt_25Y\n",
      "600: 1pt_30Y\n",
      "700: 1pt_35Y\n",
      "800: 1pt_40Y\n",
      "900: 1pt_45Y\n",
      "1000: 1pt_50Y\n",
      "1100: 1pt_55Y\n",
      "6055 nt seqs made\n",
      "2.584538 sec elapsed\n",
      "\n",
      "./output/libraries/POU_DBD_1_200_orf_library_N=6055_time=25.07.02.15h.29m.21s.csv\n",
      "File saved\n",
      "3.527450 sec elapsed\n",
      "------------------------------------------------\n",
      "\n",
      "\n",
      "Processing ./output/libraries/POU_DBD_1_200_orf_library_N=6055_time=25.07.02.15h.29m.21s.csv\n",
      "WT aa seq (L=55):\n",
      "\tDEPSDLEELEKFAKTFKQRRIKLGFTQGDVGLAMGKLYGNDFSQTTISRFEALNL\n",
      "WT dna seq (L=165):\n",
      "\tGATGAGCCTAGCGATCTGGAGGAACTGGAAAAGTTTGCCAAGACTTTCAAACAGAGACGGATCAAACTGGGCTTCACCCAGGGGGACGTGGGACTGGCTATGGGAAAGCTGTACGGGAATGATTTCAGCCAGACAACAATCAGCCGGTTTGAGGCACTGAATCTG\n",
      "WT oligo seq (L=198):\n",
      "\tgctctggaggggccGATGAGCCTAGCGATCTGGAGGAACTGGAAAAGTTTGCCAAGACTTTCAAACAGAGACGGATCAAACTGGGCTTCACCCAGGGGGACGTGGGACTGGCTATGGGAAAGCTGTACGGGAATGATTTCAGCCAGACAACAATCAGCCGGTTTGAGGCACTGAATCTGagcttcaagaacatgtgca\n",
      "Number of 0 variants: 665\n",
      "Number of 1 variants: 5390\n",
      "Total number of variants: 6055\n",
      "Number of 0 mutant variants: 1\n",
      "Number of 1 mutant variants: 1100\n",
      "Fraction of possible 0 mutants: 1.0\n",
      "Fraction of possible 1 mutants: 1.0\n",
      "Total counts in 1 mutant heatmap: 5390.0\n",
      "Heatmap saved as 1pt_heatmap_POU_DBD_1_200_orf_library_N=6055_time=25.07.02.15h.29m.21s.pdf\n",
      "Mutant observances in 1 mutant heatmap: 1100.0\n",
      "Heatmap saved as 1pt_mutant_heatmap_POU_DBD_1_200_orf_library_N=6055_time=25.07.02.15h.29m.21s.pdf\n",
      "Number of 2pt variants: 0\n",
      "Output checked\n",
      "4.118472 sec elapsed\n"
     ]
    }
   ],
   "source": [
    "# make an all singles POU_DBD_1 library\n",
    "\n",
    "LibraryMaker('GATGAGCCTAGCGATCTGGAGGAACTGGAAAAGTTTGCCAAGACTTTCAAACAGAGACGGATCAAACTGGGCTTCACCCAGGGGGACGTGGGACTGGCTATGGGAAAGCTGTACGGGAATGATTTCAGCCAGACAACAATCAGCCGGTTTGAGGCACTGAATCTG', \n",
    "             single_mutants = True, \n",
    "             doubles_to_make = 0, \n",
    "             var_num = 5, wt_num = 665, max_tries = 100, stop_num=3,\n",
    "             upstream_dna = 'gctctggaggggcc',\n",
    "             downstream_dna = 'agcttcaagaacatgtgca',\n",
    "             out_path='./output/libraries/', name='POU_DBD_1_200', fig_width=8,\n",
    "             fig_path='./output/figs/')\n",
    "\n",
    "plt.close('all')\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Making singles\n",
      "1400 single mutants made\n",
      "0.001941 sec elapsed\n",
      "\n",
      "Making nt seqs\n",
      "0: 0pt_WT\n",
      "100: 1pt_05Y\n",
      "200: 1pt_10Y\n",
      "300: 1pt_15Y\n",
      "400: 1pt_20Y\n",
      "500: 1pt_25Y\n",
      "600: 1pt_30Y\n",
      "700: 1pt_35Y\n",
      "800: 1pt_40Y\n",
      "900: 1pt_45Y\n",
      "1000: 1pt_50Y\n",
      "1100: 1pt_55Y\n",
      "1200: 1pt_60Y\n",
      "1300: 1pt_65Y\n",
      "1400: 1pt_70Y\n",
      "7860 nt seqs made\n",
      "4.330492 sec elapsed\n",
      "\n",
      "./output/libraries/POU_DBD_2_250_orf_library_N=7860_time=25.07.02.15h.29m.25s.csv\n",
      "File saved\n",
      "5.888980 sec elapsed\n",
      "------------------------------------------------\n",
      "\n",
      "\n",
      "Processing ./output/libraries/POU_DBD_2_250_orf_library_N=7860_time=25.07.02.15h.29m.25s.csv\n",
      "WT aa seq (L=70):\n",
      "\tEALNLSFKNMCKLKPLLEKWLNDAESSPSDPSVSTPSSYPSLSEVFGRKRKKRTSIETNIRLTLEKRFQD\n",
      "WT dna seq (L=210):\n",
      "\tGAGGCACTGAATCTGTCCTTTAAGAACATGTGCAAACTGAAGCCTCTGCTGGAAAAGTGGCTGAACGACGCCGAAAGCAGCCCATCCGACCCATCCGTGTCCACACCATCCTCCTATCCAAGCCTGAGCGAGGTGTTCGGAAGGAAAAGGAAAAAAAGGACATCCATTGAAACCAACATTAGGCTGACTCTGGAAAAAAGATTCCAGGAT\n",
      "WT oligo seq (L=246):\n",
      "\tgaccaccatctcacgatttGAGGCACTGAATCTGTCCTTTAAGAACATGTGCAAACTGAAGCCTCTGCTGGAAAAGTGGCTGAACGACGCCGAAAGCAGCCCATCCGACCCATCCGTGTCCACACCATCCTCCTATCCAAGCCTGAGCGAGGTGTTCGGAAGGAAAAGGAAAAAAAGGACATCCATTGAAACCAACATTAGGCTGACTCTGGAAAAAAGATTCCAGGATaacccaaaacccagctc\n",
      "Number of 0 variants: 1000\n",
      "Number of 1 variants: 6860\n",
      "Total number of variants: 7860\n",
      "Number of 0 mutant variants: 1\n",
      "Number of 1 mutant variants: 1400\n",
      "Fraction of possible 0 mutants: 1.0\n",
      "Fraction of possible 1 mutants: 1.0\n",
      "Total counts in 1 mutant heatmap: 6860.0\n",
      "Heatmap saved as 1pt_heatmap_POU_DBD_2_250_orf_library_N=7860_time=25.07.02.15h.29m.25s.pdf\n",
      "Mutant observances in 1 mutant heatmap: 1400.0\n",
      "Heatmap saved as 1pt_mutant_heatmap_POU_DBD_2_250_orf_library_N=7860_time=25.07.02.15h.29m.25s.pdf\n",
      "Number of 2pt variants: 0\n",
      "Output checked\n",
      "6.602271 sec elapsed\n"
     ]
    }
   ],
   "source": [
    "# make an all singles POU_DBD_2 library\n",
    "\n",
    "LibraryMaker('GAGGCACTGAATCTGTCCTTTAAGAACATGTGCAAACTGAAGCCTCTGCTGGAAAAGTGGCTGAACGACGCCGAAAGCAGCCCATCCGACCCATCCGTGTCCACACCATCCTCCTATCCAAGCCTGAGCGAGGTGTTCGGAAGGAAAAGGAAAAAAAGGACATCCATTGAAACCAACATTAGGCTGACTCTGGAAAAAAGATTCCAGGAT', \n",
    "             single_mutants = True, \n",
    "             doubles_to_make = 0, \n",
    "             var_num = 5, wt_num = 1000, max_tries = 100, stop_num=3,\n",
    "             upstream_dna = 'gaccaccatctcacgattt',\n",
    "             downstream_dna = 'aacccaaaacccagctc',\n",
    "             out_path='./output/libraries/', name='POU_DBD_2_250', fig_width=8,\n",
    "             fig_path='./output/figs/')\n",
    "\n",
    "plt.close('all')\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Making singles\n",
      "1100 single mutants made\n",
      "0.002177 sec elapsed\n",
      "\n",
      "Making nt seqs\n",
      "0: 0pt_WT\n",
      "100: 1pt_05Y\n",
      "200: 1pt_10Y\n",
      "300: 1pt_15Y\n",
      "400: 1pt_20Y\n",
      "500: 1pt_25Y\n",
      "600: 1pt_30Y\n",
      "700: 1pt_35Y\n",
      "800: 1pt_40Y\n",
      "900: 1pt_45Y\n",
      "1000: 1pt_50Y\n",
      "1100: 1pt_55Y\n",
      "6055 nt seqs made\n",
      "2.640779 sec elapsed\n",
      "\n",
      "./output/libraries/POU_DBD_3_200_orf_library_N=6055_time=25.07.02.15h.29m.32s.csv\n",
      "File saved\n",
      "3.591912 sec elapsed\n",
      "------------------------------------------------\n",
      "\n",
      "\n",
      "Processing ./output/libraries/POU_DBD_3_200_orf_library_N=6055_time=25.07.02.15h.29m.32s.csv\n",
      "WT aa seq (L=55):\n",
      "\tRFQDNPKPSSEEISMIAEQLSMEKEVVRVWFCNRRQKEKRINCPVATPIKPPVYN\n",
      "WT dna seq (L=165):\n",
      "\tCGGTTCCAGGACAATCCCAAACCATCCAGCGAGGAGATTTCCATGATCGCAGAGCAGCTGTCCATGGAAAAAGAAGTGGTGCGGGTGTGGTTTTGTAACAGAAGACAGAAAGAGAAGCGGATCAACTGTCCCGTGGCCACACCAATCAAACCCCCAGTGTATAAT\n",
      "WT oligo seq (L=200):\n",
      "\tcgcctCacCctCgagaagCGGTTCCAGGACAATCCCAAACCATCCAGCGAGGAGATTTCCATGATCGCAGAGCAGCTGTCCATGGAAAAAGAAGTGGTGCGGGTGTGGTTTTGTAACAGAAGACAGAAAGAGAAGCGGATCAACTGTCCCGTGGCCACACCAATCAAACCCCCAGTGTATAATtcccggctggtatctcc\n",
      "Number of 0 variants: 665\n",
      "Number of 1 variants: 5390\n",
      "Total number of variants: 6055\n",
      "Number of 0 mutant variants: 1\n",
      "Number of 1 mutant variants: 1100\n",
      "Fraction of possible 0 mutants: 1.0\n",
      "Fraction of possible 1 mutants: 1.0\n",
      "Total counts in 1 mutant heatmap: 5390.0\n",
      "Heatmap saved as 1pt_heatmap_POU_DBD_3_200_orf_library_N=6055_time=25.07.02.15h.29m.32s.pdf\n",
      "Mutant observances in 1 mutant heatmap: 1100.0\n",
      "Heatmap saved as 1pt_mutant_heatmap_POU_DBD_3_200_orf_library_N=6055_time=25.07.02.15h.29m.32s.pdf\n",
      "Number of 2pt variants: 0\n",
      "Output checked\n",
      "4.331278 sec elapsed\n"
     ]
    }
   ],
   "source": [
    "# make an all singles POU_DBD_3 library\n",
    "\n",
    "LibraryMaker('CGGTTCCAGGACAATCCCAAACCATCCAGCGAGGAGATTTCCATGATCGCAGAGCAGCTGTCCATGGAAAAAGAAGTGGTGCGGGTGTGGTTTTGTAACAGAAGACAGAAAGAGAAGCGGATCAACTGTCCCGTGGCCACACCAATCAAACCCCCAGTGTATAAT', \n",
    "             single_mutants = True, \n",
    "             doubles_to_make = 0, \n",
    "             var_num = 5, wt_num = 665, max_tries = 100, stop_num=3,\n",
    "             upstream_dna = 'cgcctCacCctCgagaag',\n",
    "             downstream_dna = 'tcccggctggtatctcc',\n",
    "             out_path='./output/libraries/', name='POU_DBD_3_200', fig_width=8,\n",
    "             fig_path='./output/figs/')\n",
    "\n",
    "plt.close('all')\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "DMS_Designer",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.23"
  },
  "varInspector": {
   "cols": {
    "lenName": 16,
    "lenType": 16,
    "lenVar": 40
   },
   "kernels_config": {
    "python": {
     "delete_cmd_postfix": "",
     "delete_cmd_prefix": "del ",
     "library": "var_list.py",
     "varRefreshCmd": "print(var_dic_list())"
    },
    "r": {
     "delete_cmd_postfix": ") ",
     "delete_cmd_prefix": "rm(",
     "library": "var_list.r",
     "varRefreshCmd": "cat(var_dic_list()) "
    }
   },
   "types_to_exclude": [
    "module",
    "function",
    "builtin_function_or_method",
    "instance",
    "_Feature"
   ],
   "window_display": false
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
