<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Running the QC checks for the merged POU library &mdash; DMS Designer v0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Making variant effect heatmaps for the POU library" href="create_POU_heatmaps.html" />
    <link rel="prev" title="Mergeing the POU libraries" href="merge_POU_libraries.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            DMS Designer
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Example Notebooks:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../notebooks.html">Example Notebooks</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../notebooks.html#library-production">Library production</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../notebooks.html#library-analysis">Library analysis</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="merge_POU_libraries.html">Mergeing the POU libraries</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Running the QC checks for the merged POU library</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Importing-libraries">Importing libraries</a></li>
<li class="toctree-l4"><a class="reference internal" href="#loading-the-library">loading the library</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Assessing-the-counts-associated-with-each-library-member">Assessing the counts associated with each library member</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Assessing-the-counts-associated-with-each-variant">Assessing the counts associated with each variant</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Evaluating-assay-dynamic-range">Evaluating assay dynamic range</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Checking-for-evidence-that-the-library-experience-selection-before-the-assay-began">Checking for evidence that the library experience selection before the assay began</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="create_POU_heatmaps.html">Making variant effect heatmaps for the POU library</a></li>
<li class="toctree-l3"><a class="reference internal" href="OCA_T1_analysis.html">Running a full analysis of the OCA_T1 library</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">DMS_designer</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">DMS Designer</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../notebooks.html">Example Notebooks</a></li>
      <li class="breadcrumb-item active">Running the QC checks for the merged POU library</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/notebooks/run_POU_QC.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="admonition note">
<p class="admonition-title">Note</p>
<p>This page was generated from a Jupyter notebook.
<code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">the</span> <span class="pre">notebook</span></code></p>
</div>
<section id="Running-the-QC-checks-for-the-merged-POU-library">
<h1>Running the QC checks for the merged POU library<a class="headerlink" href="#Running-the-QC-checks-for-the-merged-POU-library" title="Permalink to this heading"></a></h1>
<section id="Importing-libraries">
<h2>Importing libraries<a class="headerlink" href="#Importing-libraries" title="Permalink to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">DMS_designer</span><span class="w"> </span><span class="kn">import</span> <span class="n">Library</span>
</pre></div>
</div>
</div>
</section>
<section id="loading-the-library">
<h2>loading the library<a class="headerlink" href="#loading-the-library" title="Permalink to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lib_merged</span> <span class="o">=</span> <span class="n">Library</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;./output/libraries/POU2F3_merged.pkl&#39;</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
</section>
<section id="Assessing-the-counts-associated-with-each-library-member">
<h2>Assessing the counts associated with each library member<a class="headerlink" href="#Assessing-the-counts-associated-with-each-library-member" title="Permalink to this heading"></a></h2>
<p>The vast majority of library members have very simmilar count numbers, but there is one library member that forms a large outlier.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;husl&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="n">fig_read</span><span class="p">,</span> <span class="n">fig_frac</span> <span class="o">=</span> <span class="n">lib_merged</span><span class="o">.</span><span class="n">check_barcode_distribution_depth</span><span class="p">()</span>

<span class="n">leg</span> <span class="o">=</span> <span class="n">fig_read</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_legend</span><span class="p">()</span>
<span class="n">leg</span><span class="o">.</span><span class="n">set_bbox_to_anchor</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>

<span class="n">leg</span> <span class="o">=</span> <span class="n">fig_frac</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_legend</span><span class="p">()</span>
<span class="n">leg</span><span class="o">.</span><span class="n">set_bbox_to_anchor</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_run_POU_QC_6_0.png" src="../_images/notebooks_run_POU_QC_6_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_run_POU_QC_6_1.png" src="../_images/notebooks_run_POU_QC_6_1.png" />
</div>
</div>
<p>This also manifests when looking at the eveness of the read distribution by library members</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">lib_merged</span><span class="o">.</span><span class="n">check_barcode_distribution_skew</span><span class="p">()</span>

<span class="n">leg</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_legend</span><span class="p">()</span>
<span class="n">leg</span><span class="o">.</span><span class="n">set_bbox_to_anchor</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_run_POU_QC_8_0.png" src="../_images/notebooks_run_POU_QC_8_0.png" />
</div>
</div>
</section>
<section id="Assessing-the-counts-associated-with-each-variant">
<h2>Assessing the counts associated with each variant<a class="headerlink" href="#Assessing-the-counts-associated-with-each-variant" title="Permalink to this heading"></a></h2>
<p>When reads are averaged across library members to get the representation by variant, the distribution is much more even.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;husl&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="n">fig_read</span><span class="p">,</span> <span class="n">fig_frac</span> <span class="o">=</span> <span class="n">lib_merged</span><span class="o">.</span><span class="n">check_depth</span><span class="p">()</span>


<span class="n">leg</span> <span class="o">=</span> <span class="n">fig_read</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_legend</span><span class="p">()</span>
<span class="n">leg</span><span class="o">.</span><span class="n">set_bbox_to_anchor</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>

<span class="n">leg</span> <span class="o">=</span> <span class="n">fig_frac</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_legend</span><span class="p">()</span>
<span class="n">leg</span><span class="o">.</span><span class="n">set_bbox_to_anchor</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># plt.show()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_run_POU_QC_10_0.png" src="../_images/notebooks_run_POU_QC_10_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_run_POU_QC_10_1.png" src="../_images/notebooks_run_POU_QC_10_1.png" />
</div>
</div>
<p>The low skew before selection and higher skew after selection suggests that the library was effectively selected. And that the library had good representation before selection.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">lib_merged</span><span class="o">.</span><span class="n">check_skew</span><span class="p">()</span>

<span class="n">leg</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_legend</span><span class="p">()</span>
<span class="n">leg</span><span class="o">.</span><span class="n">set_bbox_to_anchor</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_run_POU_QC_12_0.png" src="../_images/notebooks_run_POU_QC_12_0.png" />
</div>
</div>
</section>
<section id="Evaluating-assay-dynamic-range">
<h2>Evaluating assay dynamic range<a class="headerlink" href="#Evaluating-assay-dynamic-range" title="Permalink to this heading"></a></h2>
<p>By looking at the seperation of the positive and negative controls in the assay, we can evaluate the dynamic range of the assay. In this assay, the positive and negative controls are well seperated and highly seperable, which means the assay is working well.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lib_merged</span><span class="o">.</span><span class="n">check_controls</span><span class="p">(</span><span class="s1">&#39;AA&#39;</span><span class="p">,[</span><span class="s1">&#39;WT&#39;</span><span class="p">],[</span><span class="s1">&#39;*&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Number of true positives: 2330

Aggregate stats
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_run_POU_QC_14_1.png" src="../_images/notebooks_run_POU_QC_14_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_run_POU_QC_14_2.png" src="../_images/notebooks_run_POU_QC_14_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_run_POU_QC_14_3.png" src="../_images/notebooks_run_POU_QC_14_3.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_run_POU_QC_14_4.png" src="../_images/notebooks_run_POU_QC_14_4.png" />
</div>
</div>
</section>
<section id="Checking-for-evidence-that-the-library-experience-selection-before-the-assay-began">
<h2>Checking for evidence that the library experience selection before the assay began<a class="headerlink" href="#Checking-for-evidence-that-the-library-experience-selection-before-the-assay-began" title="Permalink to this heading"></a></h2>
<p>There is no clear relationship between fitness values and initial abundances, suggesting that no preselection occured.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lib_merged</span><span class="o">.</span><span class="n">make_initial_skew_checks</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_run_POU_QC_16_0.png" src="../_images/notebooks_run_POU_QC_16_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_run_POU_QC_16_1.png" src="../_images/notebooks_run_POU_QC_16_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_run_POU_QC_16_2.png" src="../_images/notebooks_run_POU_QC_16_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_run_POU_QC_16_3.png" src="../_images/notebooks_run_POU_QC_16_3.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_run_POU_QC_16_4.png" src="../_images/notebooks_run_POU_QC_16_4.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_run_POU_QC_16_5.png" src="../_images/notebooks_run_POU_QC_16_5.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="merge_POU_libraries.html" class="btn btn-neutral float-left" title="Mergeing the POU libraries" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="create_POU_heatmaps.html" class="btn btn-neutral float-right" title="Making variant effect heatmaps for the POU library" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, John J Desmarais.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>